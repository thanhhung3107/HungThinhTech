<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Th·ªëng k√™ doanh thu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
          integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <style>
        .report-card {
            cursor: pointer;
            transition: transform 0.2s ease-in-out, background-color 0.2s;
        }

        .report-card:hover {
            transform: scale(1.03);
            background-color: #f1f1f1;
        }

        .report-section {
            display: none;
        }

        .active-section {
            display: block;
        }

        .card-icon {
            font-size: 2rem;
            color: #0d6efd;
        }

        .card-title {
            margin-top: 0.5rem;
        }

        .report-section {
            display: none;
            opacity: 0;
            transition: opacity 0.4s ease-in-out;
        }

        .active-section {
            display: block;
            opacity: 1;
        }

        .card.report-card.active {
            background-color: #e3f2fd;
            border: 1px solid #0d6efd;
        }

        #backToTopBtn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 999;
            display: none;
            background-color: #0d6efd;
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            font-size: 1.5rem;
        }

        #backToTopBtn:hover {
            background-color: #0056b3;
        }

    </style>
</head>
<body>
<div class="container py-5">
    <h1 class="mb-4 text-center">üìä T·ªïng h·ª£p th·ªëng k√™ doanh thu</h1>

    <div class="d-flex justify-content-center gap-3 mb-4">
        <a href="/admin/dashboard" class="btn btn-outline-secondary">
            <i class="fa-solid fa-arrow-left"></i> Quay v·ªÅ trang Admin
        </a>
        <a href="/index" class="btn btn-outline-primary">
            <i class="fa-solid fa-house"></i> V·ªÅ trang Ch·ªß
        </a>
    </div>

    <!-- Filter Form -->
    <form class="row g-3 mb-4" method="get" th:action="@{/admin/revenue}">
        <div class="col-md-4">
            <label for="from" class="form-label">T·ª´ ng√†y</label>
            <input type="date" id="from" name="from" class="form-control"
                   th:value="${from != null ? #dates.format(from,'yyyy-MM-dd') : ''}">
        </div>
        <div class="col-md-4">
            <label for="to" class="form-label">ƒê·∫øn ng√†y</label>
            <input type="date" id="to" name="to" class="form-control"
                   th:value="${to != null ? #dates.format(to,'yyyy-MM-dd') : ''}">
        </div>
        <div class="col-md-4 align-self-end">
            <button type="submit" class="btn btn-primary w-100"><i class="fa-solid fa-filter"></i> L·ªçc theo ng√†y
            </button>
        </div>
    </form>

    <!-- Cards Section -->
    <div class="row row-cols-1 row-cols-md-3 g-4">
        <div class="col">
            <div class="card report-card text-center" onclick="showSection('section-day')">
                <div class="card-body">
                    <i class="fa-solid fa-calendar-day card-icon"></i>
                    <h5 class="card-title">Theo ng√†y</h5>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card report-card text-center" onclick="showSection('section-month')">
                <div class="card-body">
                    <i class="fa-solid fa-calendar-alt card-icon"></i>
                    <h5 class="card-title">Theo th√°ng</h5>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card report-card text-center" onclick="showSection('section-year')">
                <div class="card-body">
                    <i class="fa-solid fa-calendar card-icon"></i>
                    <h5 class="card-title">Theo nƒÉm</h5>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card report-card text-center" onclick="showSection('section-product')">
                <div class="card-body">
                    <i class="fa-solid fa-box-open card-icon"></i>
                    <h5 class="card-title">Theo s·∫£n ph·∫©m</h5>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card report-card text-center" onclick="showSection('section-category')">
                <div class="card-body">
                    <i class="fa-solid fa-tags card-icon"></i>
                    <h5 class="card-title">Theo danh m·ª•c</h5>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card report-card text-center" onclick="showSection('section-payment')">
                <div class="card-body">
                    <i class="fa-solid fa-credit-card card-icon"></i>
                    <h5 class="card-title">Theo thanh to√°n</h5>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card report-card text-center" onclick="showSection('section-user')">
                <div class="card-body">
                    <i class="fa-solid fa-user card-icon"></i>
                    <h5 class="card-title">Theo ng∆∞·ªùi d√πng</h5>
                </div>
            </div>
        </div>
    </div>

    <hr class="my-5">

    <div id="section-day" class="report-section">
        <h4>Doanh thu theo ng√†y</h4>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>Ng√†y</th>
                <th class="text-end">Doanh thu</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="row : ${byDay}">
                <td th:text="${row[0]}"></td>
                <td class="text-end" th:text="${#numbers.formatDecimal(row[1],0,'COMMA',0,'POINT') + ' ‚Ç´'}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div id="section-month" class="report-section">
        <h4>Doanh thu theo th√°ng</h4>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>Th√°ng</th>
                <th class="text-end">Doanh thu</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="row : ${byMonth}">
                <td th:text="${row[0]} + '-' + ${row[1]}"></td>
                <td class="text-end" th:text="${#numbers.formatDecimal(row[2],0,'COMMA',0,'POINT') + ' ‚Ç´'}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div id="section-year" class="report-section">
        <h4>Doanh thu theo nƒÉm</h4>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>NƒÉm</th>
                <th class="text-end">Doanh thu</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="row : ${byYear}">
                <td th:text="${row[0]}"></td>
                <td class="text-end" th:text="${#numbers.formatDecimal(row[1],0,'COMMA',0,'POINT') + ' ‚Ç´'}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div id="section-product" class="report-section">
        <h4>Doanh thu theo s·∫£n ph·∫©m</h4>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>ID</th>
                <th>T√™n s·∫£n ph·∫©m</th>
                <th class="text-end">Doanh thu</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="row : ${byProduct}">
                <td th:text="${row[0]}"></td>
                <td th:text="${row[1]}"></td>
                <td class="text-end" th:text="${#numbers.formatDecimal(row[2],0,'COMMA',0,'POINT') + ' ‚Ç´'}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div id="section-category" class="report-section">
        <h4>Doanh thu theo danh m·ª•c</h4>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>ID</th>
                <th>T√™n danh m·ª•c</th>
                <th class="text-end">Doanh thu</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="row : ${byCategory}">
                <td th:text="${row[0]}"></td>
                <td th:text="${row[1]}"></td>
                <td class="text-end" th:text="${#numbers.formatDecimal(row[2],0,'COMMA',0,'POINT') + ' ‚Ç´'}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div id="section-payment" class="report-section">
        <h4>Doanh thu theo ph∆∞∆°ng th·ª©c thanh to√°n</h4>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>Ph∆∞∆°ng th·ª©c</th>
                <th class="text-end">Doanh thu</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="row : ${byPayment}">
                <td th:text="${row[0] != null ? row[0] : 'N/A'}"></td>
                <td class="text-end" th:text="${#numbers.formatDecimal(row[1],0,'COMMA',0,'POINT') + ' ‚Ç´'}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div id="section-user" class="report-section">
        <h4>Doanh thu theo ng∆∞·ªùi d√πng</h4>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>ID</th>
                <th>H·ªç t√™n</th>
                <th class="text-end">Doanh thu</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="row : ${byUser}">
                <td th:text="${row[0]}"></td>
                <td th:text="${row[1]}"></td>
                <td class="text-end" th:text="${#numbers.formatDecimal(row[2],0,'COMMA',0,'POINT') + ' ‚Ç´'}"></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- N√∫t quay l·∫°i ƒë·∫ßu trang -->
<button id="backToTopBtn" onclick="scrollToTop()">
    <i class="fa-solid fa-arrow-up"></i>
</button>

<script>
    function showSection(id) {
        // ·∫®n t·∫•t c·∫£ section
        document.querySelectorAll('.report-section').forEach(section => {
            section.classList.remove('active-section');
        });
        // G·ª° active card
        document.querySelectorAll('.report-card').forEach(card => {
            card.classList.remove('active');
        });

        // Hi·ªán section ƒë∆∞·ª£c ch·ªçn
        const section = document.getElementById(id);
        if (section) section.classList.add('active-section');

        // T√¥ ƒë·∫≠m card ƒëang ch·ªçn
        const card = document.querySelector(`[onclick="showSection('${id}')"]`);
        if (card) card.classList.add('active');
    }

    // Hi·ªÉn th·ªã m·∫∑c ƒë·ªãnh "theo ng√†y"
    window.addEventListener("DOMContentLoaded", () => {
        showSection('section-day');
    });

    // X·ª≠ l√Ω n√∫t scroll l√™n ƒë·∫ßu trang
    const backToTopBtn = document.getElementById("backToTopBtn");
    window.addEventListener("scroll", () => {
        backToTopBtn.style.display = window.scrollY > 200 ? "block" : "none";
    });

    function scrollToTop() {
        window.scrollTo({top: 0, behavior: "smooth"});
    }
</script>

</body>
</html>
